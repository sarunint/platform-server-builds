{"version":3,"file":"server_renderer.js","sourceRoot":"","sources":["../../../../../packages/platform-server/src/server_renderer.ts"],"names":[],"mappings":";;;;;;;;;;;;AAQA,OAAO,EAAC,wBAAwB,EAAC,MAAM,mBAAmB,CAAC;AAC3D,OAAO,EAAS,MAAM,EAAE,UAAU,EAAE,MAAM,EAAgH,iBAAiB,EAA0B,MAAM,eAAe,CAAC;AAC3N,OAAO,EAAC,QAAQ,EAAE,YAAY,EAAE,eAAe,IAAI,cAAc,EAAE,iBAAiB,IAAI,gBAAgB,EAAE,cAAc,IAAI,aAAa,EAAE,OAAO,IAAI,MAAM,EAAE,qBAAqB,IAAI,oBAAoB,EAAE,kBAAkB,IAAI,iBAAiB,EAAC,MAAM,2BAA2B,CAAC;;AAEvR,IAAM,WAAW,GAAU,EAAE,CAAC;;IAQ5B,gCACY,cAAoC,MAAc,EAChC,QAAa,EAAU,gBAAkC;QAD3E,iBAAY,GAAZ,YAAY;QAAwB,WAAM,GAAN,MAAM,CAAQ;QAChC,aAAQ,GAAR,QAAQ,CAAK;QAAU,qBAAgB,GAAhB,gBAAgB,CAAkB;gCAN5D,IAAI,GAAG,EAAqB;sBAEtC,IAAI,wBAAwB,EAAE;QAK7C,IAAI,CAAC,eAAe,GAAG,IAAI,sBAAsB,CAAC,YAAY,EAAE,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;KAChG;;;;;;IAED,+CAAc;;;;;IAAd,UAAe,OAAY,EAAE,IAAwB;QACnD,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,EAAE;YACrB,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QACD,QAAQ,IAAI,CAAC,aAAa,EAAE;YAC1B,KAAK,iBAAiB,CAAC,MAAM,CAAC;YAC9B,KAAK,iBAAiB,CAAC,QAAQ,CAAC,CAAC;;gBAC/B,IAAI,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,QAAQ,EAAE;oBACb,QAAQ,GAAG,IAAI,oCAAoC,CAC/C,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,MAAM,EACjF,IAAI,CAAC,CAAC;oBACV,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;iBAC9C;gBACD,mBAAuC,QAAQ,EAAC,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACtE,OAAO,QAAQ,CAAC;aACjB;YACD,KAAK,iBAAiB,CAAC,MAAM;gBAC3B,MAAM,IAAI,KAAK,CAAC,sDAAsD,CAAC,CAAC;YAC1E,OAAO,CAAC,CAAC;gBACP,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;;oBACvC,IAAM,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;oBACvD,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;oBACxC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;iBAC1D;gBACD,OAAO,IAAI,CAAC,eAAe,CAAC;aAC7B;SACF;KACF;;;;IAED,sCAAK;;;IAAL,eAAU;;;;IACV,oCAAG;;;IAAH,eAAQ;;gBA3CT,UAAU;;;;gBAJO,YAAY;gBADM,MAAM;gDAanC,MAAM,SAAC,QAAQ;gBAZkE,gBAAgB;;iCAVxG;;SAea,sBAAsB;;;;;;;;;;;;;;;;;AA6CnC,IAAA;IAGE,gCACY,cAAsC,QAAa,EAAU,MAAc,EAC3E;QADA,iBAAY,GAAZ,YAAY;QAA0B,aAAQ,GAAR,QAAQ,CAAK;QAAU,WAAM,GAAN,MAAM,CAAQ;QAC3E,WAAM,GAAN,MAAM;QAJlB,YAA6B,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KAID;;;;IAEhD,wCAAO;;;IAAP,eAAkB;;;;;;;IAIlB,8CAAa;;;;;;IAAb,UAAc,IAAY,EAAE,SAAkB,EAAE,SAAe;QAC7D,IAAI,SAAS,EAAE;YACb,OAAO,MAAM,EAAE,CAAC,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;SACjF;QAED,OAAO,MAAM,EAAE,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;KACpD;;;;;;IAED,8CAAa;;;;;IAAb,UAAc,KAAa,EAAE,SAAe,IAAS,OAAO,MAAM,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE;;;;;;IAE5F,2CAAU;;;;;IAAV,UAAW,KAAa,EAAE,SAAe,IAAS,OAAO,MAAM,EAAE,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE;;;;;;IAE1F,4CAAW;;;;;IAAX,UAAY,MAAW,EAAE,QAAa,IAAU,MAAM,EAAE,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,EAAE;;;;;;;IAEzF,6CAAY;;;;;;IAAZ,UAAa,MAAW,EAAE,QAAa,EAAE,QAAa;QACpD,IAAI,MAAM,EAAE;YACV,MAAM,EAAE,CAAC,YAAY,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;SACnD;KACF;;;;;;IAED,4CAAW;;;;;IAAX,UAAY,MAAW,EAAE,QAAa;QACpC,IAAI,MAAM,EAAE;YACV,MAAM,EAAE,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SACxC;KACF;;;;;;IAED,kDAAiB;;;;;IAAjB,UAAkB,cAA0B,EAAE,SAAe;;QAC3D,IAAI,EAAE,CAAM;QACZ,IAAI,OAAO,cAAc,KAAK,QAAQ,EAAE;YACtC,EAAE,GAAG,MAAM,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;YAC3D,IAAI,CAAC,EAAE,EAAE;gBACP,MAAM,IAAI,KAAK,CAAC,oBAAiB,cAAc,kCAA8B,CAAC,CAAC;aAChF;SACF;aAAM;YACL,EAAE,GAAG,cAAc,CAAC;SACrB;QACD,MAAM,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QACxB,OAAO,EAAE,CAAC;KACX;;;;;IAED,2CAAU;;;;IAAV,UAAW,IAAS,IAAS,OAAO,MAAM,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,EAAE;;;;;IAEnE,4CAAW;;;;IAAX,UAAY,IAAS,IAAS,OAAO,MAAM,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,EAAE;;;;;;;;IAElE,6CAAY;;;;;;;IAAZ,UAAa,EAAO,EAAE,IAAY,EAAE,KAAa,EAAE,SAAkB;QACnE,IAAI,SAAS,EAAE;YACb,MAAM,EAAE,CAAC,cAAc,CAAC,EAAE,EAAE,cAAc,CAAC,SAAS,CAAC,EAAE,SAAS,GAAG,GAAG,GAAG,IAAI,EAAE,KAAK,CAAC,CAAC;SACvF;aAAM;YACL,MAAM,EAAE,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;SACxC;KACF;;;;;;;IAED,gDAAe;;;;;;IAAf,UAAgB,EAAO,EAAE,IAAY,EAAE,SAAkB;QACvD,IAAI,SAAS,EAAE;YACb,MAAM,EAAE,CAAC,iBAAiB,CAAC,EAAE,EAAE,cAAc,CAAC,SAAS,CAAC,EAAE,IAAI,CAAC,CAAC;SACjE;aAAM;YACL,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;SACpC;KACF;;;;;;IAED,yCAAQ;;;;;IAAR,UAAS,EAAO,EAAE,IAAY,IAAU,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,EAAE;;;;;;IAEtE,4CAAW;;;;;IAAX,UAAY,EAAO,EAAE,IAAY,IAAU,MAAM,EAAE,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,EAAE;;;;;;;;IAE5E,yCAAQ;;;;;;;IAAR,UAAS,EAAO,EAAE,KAAa,EAAE,KAAU,EAAE,KAA0B;QACrE,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;KACrC;;;;;;;IAED,4CAAW;;;;;;IAAX,UAAY,EAAO,EAAE,KAAa,EAAE,KAA0B;QAC5D,MAAM,EAAE,CAAC,WAAW,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;KACjC;;;;;;IAMO,yDAAwB;;;;;cAAC,OAAe,EAAE,YAAoB;QACpE,OAAO,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,OAAO,EAAE,YAAY,EAAE,IAAI,CAAC;YAC3D,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,OAAO,EAAE,YAAY,EAAE,KAAK,CAAC,CAAC;;;;;;;;IAGhE,4CAAW;;;;;;IAAX,UAAY,EAAO,EAAE,IAAY,EAAE,KAAU;QAC3C,oBAAoB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;QACvC,MAAM,EAAE,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;;QAItC,IAAM,OAAO,GAAG,mBAAC,EAAE,CAAC,OAAiB,EAAC,CAAC,WAAW,EAAE,CAAC;QACrD,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,QAAQ,IAAI,OAAO,KAAK,IAAI,QAAQ,CAAC;YACxE,IAAI,CAAC,WAAW,EAAE,KAAK,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE,WAAW,CAAC;YAClF,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE,WAAW,CAAC;YACnD,IAAI,CAAC,wBAAwB,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE;YAChD,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;SAC/C;KACF;;;;;;IAED,yCAAQ;;;;;IAAR,UAAS,IAAS,EAAE,KAAa,IAAU,MAAM,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,EAAE;;;;;;;IAE3E,uCAAM;;;;;;IAAN,UACI,MAAsC,EAAE,SAAiB,EACzD,QAAiC;QACnC,oBAAoB,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;QAC5C,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,yBAAmB,IAAI,CAAC,YAAY,CAAC,sBAAsB,CACvD,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC,EAAC;SAC/D;QACD,0BAAmB,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAC1C,MAAM,EAAE,SAAS,EAAE,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC,GAAc;KACnF;;;;;IAEO,uDAAsB;;;;cAAC,YAAsB;;QACnD,OAAO,UAAC,KAAU;;YAGhB,IAAM,oBAAoB,GAAG,KAAI,CAAC,MAAM,CAAC,UAAU,CAAC,cAAM,OAAA,YAAY,CAAC,KAAK,CAAC,EAAnB,CAAmB,CAAC,CAAC;YAC/E,IAAI,oBAAoB,KAAK,KAAK,EAAE;gBAClC,KAAK,CAAC,cAAc,EAAE,CAAC;gBACvB,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC;aAC3B;SACF,CAAC;;iCA9LN;IAgMC,CAAA;;;;;;;;;;;;;;;;AAED,IAAM,WAAW,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;;;;;;AACtC,SAAS,oBAAoB,CAAC,IAAY,EAAE,QAAgB;IAC1D,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;QACtC,MAAM,IAAI,KAAK,CACX,yBAAuB,QAAQ,SAAI,IAAI,yGAAkG,CAAC,CAAC;KAChJ;CACF;AAED,IAAA;IAAmD,gEAAsB;IAIvE,8CACI,YAA0B,EAAE,QAAa,EAAE,MAAc,EAAE,gBAAkC,EAC7F,MAAgC,EAAU,SAAwB;QAFtE,YAGE,kBAAM,YAAY,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,SAQ9C;QAT6C,eAAS,GAAT,SAAS,CAAe;;QAGpE,IAAM,WAAW,GAAG,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC;;QACvC,IAAM,MAAM,GAAG,aAAa,CAAC,WAAW,EAAE,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAChE,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAEnC,KAAI,CAAC,WAAW,GAAG,oBAAoB,CAAC,WAAW,CAAC,CAAC;QACrD,KAAI,CAAC,QAAQ,GAAG,iBAAiB,CAAC,WAAW,CAAC,CAAC;;KAChD;;;;;IAED,0DAAW;;;;IAAX,UAAY,OAAY,IAAI,iBAAM,YAAY,YAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,EAAE;;;;;;IAE7E,4DAAa;;;;;IAAb,UAAc,MAAW,EAAE,IAAY;;QACrC,IAAM,EAAE,GAAG,iBAAM,aAAa,YAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC5D,iBAAM,YAAY,YAAC,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QAC7C,OAAO,EAAE,CAAC;KACX;+CAjOH;EA0MmD,sBAAsB,EAwBxE,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DomElementSchemaRegistry} from '@angular/compiler';\nimport {APP_ID, Inject, Injectable, NgZone, RenderComponentType, Renderer, Renderer2, RendererFactory2, RendererStyleFlags2, RendererType2, RootRenderer, ViewEncapsulation, ɵstringify as stringify} from '@angular/core';\nimport {DOCUMENT, EventManager, ɵNAMESPACE_URIS as NAMESPACE_URIS, ɵSharedStylesHost as SharedStylesHost, ɵflattenStyles as flattenStyles, ɵgetDOM as getDOM, ɵshimContentAttribute as shimContentAttribute, ɵshimHostAttribute as shimHostAttribute} from '@angular/platform-browser';\n\nconst EMPTY_ARRAY: any[] = [];\n\n@Injectable()\nexport class ServerRendererFactory2 implements RendererFactory2 {\n  private rendererByCompId = new Map<string, Renderer2>();\n  private defaultRenderer: Renderer2;\n  private schema = new DomElementSchemaRegistry();\n\n  constructor(\n      private eventManager: EventManager, private ngZone: NgZone,\n      @Inject(DOCUMENT) private document: any, private sharedStylesHost: SharedStylesHost) {\n    this.defaultRenderer = new DefaultServerRenderer2(eventManager, document, ngZone, this.schema);\n  }\n\n  createRenderer(element: any, type: RendererType2|null): Renderer2 {\n    if (!element || !type) {\n      return this.defaultRenderer;\n    }\n    switch (type.encapsulation) {\n      case ViewEncapsulation.Native:\n      case ViewEncapsulation.Emulated: {\n        let renderer = this.rendererByCompId.get(type.id);\n        if (!renderer) {\n          renderer = new EmulatedEncapsulationServerRenderer2(\n              this.eventManager, this.document, this.ngZone, this.sharedStylesHost, this.schema,\n              type);\n          this.rendererByCompId.set(type.id, renderer);\n        }\n        (<EmulatedEncapsulationServerRenderer2>renderer).applyToHost(element);\n        return renderer;\n      }\n      case ViewEncapsulation.Native:\n        throw new Error('Native encapsulation is not supported on the server!');\n      default: {\n        if (!this.rendererByCompId.has(type.id)) {\n          const styles = flattenStyles(type.id, type.styles, []);\n          this.sharedStylesHost.addStyles(styles);\n          this.rendererByCompId.set(type.id, this.defaultRenderer);\n        }\n        return this.defaultRenderer;\n      }\n    }\n  }\n\n  begin() {}\n  end() {}\n}\n\nclass DefaultServerRenderer2 implements Renderer2 {\n  data: {[key: string]: any} = Object.create(null);\n\n  constructor(\n      private eventManager: EventManager, protected document: any, private ngZone: NgZone,\n      private schema: DomElementSchemaRegistry) {}\n\n  destroy(): void {}\n\n  destroyNode: null;\n\n  createElement(name: string, namespace?: string, debugInfo?: any): any {\n    if (namespace) {\n      return getDOM().createElementNS(NAMESPACE_URIS[namespace], name, this.document);\n    }\n\n    return getDOM().createElement(name, this.document);\n  }\n\n  createComment(value: string, debugInfo?: any): any { return getDOM().createComment(value); }\n\n  createText(value: string, debugInfo?: any): any { return getDOM().createTextNode(value); }\n\n  appendChild(parent: any, newChild: any): void { getDOM().appendChild(parent, newChild); }\n\n  insertBefore(parent: any, newChild: any, refChild: any): void {\n    if (parent) {\n      getDOM().insertBefore(parent, refChild, newChild);\n    }\n  }\n\n  removeChild(parent: any, oldChild: any): void {\n    if (parent) {\n      getDOM().removeChild(parent, oldChild);\n    }\n  }\n\n  selectRootElement(selectorOrNode: string|any, debugInfo?: any): any {\n    let el: any;\n    if (typeof selectorOrNode === 'string') {\n      el = getDOM().querySelector(this.document, selectorOrNode);\n      if (!el) {\n        throw new Error(`The selector \"${selectorOrNode}\" did not match any elements`);\n      }\n    } else {\n      el = selectorOrNode;\n    }\n    getDOM().clearNodes(el);\n    return el;\n  }\n\n  parentNode(node: any): any { return getDOM().parentElement(node); }\n\n  nextSibling(node: any): any { return getDOM().nextSibling(node); }\n\n  setAttribute(el: any, name: string, value: string, namespace?: string): void {\n    if (namespace) {\n      getDOM().setAttributeNS(el, NAMESPACE_URIS[namespace], namespace + ':' + name, value);\n    } else {\n      getDOM().setAttribute(el, name, value);\n    }\n  }\n\n  removeAttribute(el: any, name: string, namespace?: string): void {\n    if (namespace) {\n      getDOM().removeAttributeNS(el, NAMESPACE_URIS[namespace], name);\n    } else {\n      getDOM().removeAttribute(el, name);\n    }\n  }\n\n  addClass(el: any, name: string): void { getDOM().addClass(el, name); }\n\n  removeClass(el: any, name: string): void { getDOM().removeClass(el, name); }\n\n  setStyle(el: any, style: string, value: any, flags: RendererStyleFlags2): void {\n    getDOM().setStyle(el, style, value);\n  }\n\n  removeStyle(el: any, style: string, flags: RendererStyleFlags2): void {\n    getDOM().removeStyle(el, style);\n  }\n\n  // The value was validated already as a property binding, against the property name.\n  // To know this value is safe to use as an attribute, the security context of the\n  // attribute with the given name is checked against that security context of the\n  // property.\n  private _isSafeToReflectProperty(tagName: string, propertyName: string): boolean {\n    return this.schema.securityContext(tagName, propertyName, true) ===\n        this.schema.securityContext(tagName, propertyName, false);\n  }\n\n  setProperty(el: any, name: string, value: any): void {\n    checkNoSyntheticProp(name, 'property');\n    getDOM().setProperty(el, name, value);\n    // Mirror property values for known HTML element properties in the attributes.\n    // Skip `innerhtml` which is conservatively marked as an attribute for security\n    // purposes but is not actually an attribute.\n    const tagName = (el.tagName as string).toLowerCase();\n    if (value != null && (typeof value === 'number' || typeof value == 'string') &&\n        name.toLowerCase() !== 'innerhtml' && this.schema.hasElement(tagName, EMPTY_ARRAY) &&\n        this.schema.hasProperty(tagName, name, EMPTY_ARRAY) &&\n        this._isSafeToReflectProperty(tagName, name)) {\n      this.setAttribute(el, name, value.toString());\n    }\n  }\n\n  setValue(node: any, value: string): void { getDOM().setText(node, value); }\n\n  listen(\n      target: 'document'|'window'|'body'|any, eventName: string,\n      callback: (event: any) => boolean): () => void {\n    checkNoSyntheticProp(eventName, 'listener');\n    if (typeof target === 'string') {\n      return <() => void>this.eventManager.addGlobalEventListener(\n          target, eventName, this.decoratePreventDefault(callback));\n    }\n    return <() => void>this.eventManager.addEventListener(\n               target, eventName, this.decoratePreventDefault(callback)) as() => void;\n  }\n\n  private decoratePreventDefault(eventHandler: Function): Function {\n    return (event: any) => {\n      // Run the event handler inside the ngZone because event handlers are not patched\n      // by Zone on the server. This is required only for tests.\n      const allowDefaultBehavior = this.ngZone.runGuarded(() => eventHandler(event));\n      if (allowDefaultBehavior === false) {\n        event.preventDefault();\n        event.returnValue = false;\n      }\n    };\n  }\n}\n\nconst AT_CHARCODE = '@'.charCodeAt(0);\nfunction checkNoSyntheticProp(name: string, nameKind: string) {\n  if (name.charCodeAt(0) === AT_CHARCODE) {\n    throw new Error(\n        `Found the synthetic ${nameKind} ${name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\n  }\n}\n\nclass EmulatedEncapsulationServerRenderer2 extends DefaultServerRenderer2 {\n  private contentAttr: string;\n  private hostAttr: string;\n\n  constructor(\n      eventManager: EventManager, document: any, ngZone: NgZone, sharedStylesHost: SharedStylesHost,\n      schema: DomElementSchemaRegistry, private component: RendererType2) {\n    super(eventManager, document, ngZone, schema);\n    // Add a 's' prefix to style attributes to indicate server.\n    const componentId = 's' + component.id;\n    const styles = flattenStyles(componentId, component.styles, []);\n    sharedStylesHost.addStyles(styles);\n\n    this.contentAttr = shimContentAttribute(componentId);\n    this.hostAttr = shimHostAttribute(componentId);\n  }\n\n  applyToHost(element: any) { super.setAttribute(element, this.hostAttr, ''); }\n\n  createElement(parent: any, name: string): Element {\n    const el = super.createElement(parent, name, this.document);\n    super.setAttribute(el, this.contentAttr, '');\n    return el;\n  }\n}\n"]}